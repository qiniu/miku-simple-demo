var mikuDeliveryPerf=function(C){"use strict";var ct=Object.defineProperty,lt=Object.defineProperties;var ut=Object.getOwnPropertyDescriptors;var Ue=Object.getOwnPropertySymbols;var dt=Object.prototype.hasOwnProperty,ft=Object.prototype.propertyIsEnumerable;var _e=(C,P,E)=>P in C?ct(C,P,{enumerable:!0,configurable:!0,writable:!0,value:E}):C[P]=E,xe=(C,P)=>{for(var E in P||(P={}))dt.call(P,E)&&_e(C,E,P[E]);if(Ue)for(var E of Ue(P))ft.call(P,E)&&_e(C,E,P[E]);return C},We=(C,P)=>lt(C,ut(P));var U=(C,P,E)=>(_e(C,typeof P!="symbol"?P+"":P,E),E);var j=(C,P,E)=>new Promise((ce,G)=>{var O=W=>{try{N(E.next(W))}catch(V){G(V)}},le=W=>{try{N(E.throw(W))}catch(V){G(V)}},N=W=>W.done?ce(W.value):Promise.resolve(W.value).then(O,le);N((E=E.apply(C,P)).next())});function P(h){return(...e)=>{console.warn(`[${h}] [${(Date.now()/1e3).toFixed(3)}]`,...e)}}const E="https://api.qiniudns.com";function ce(h){return Object.keys(h).map(e=>[e,h[e]]).filter(([e,t])=>t!==void 0).map(([e,t])=>t===null?encodeURIComponent(e):[e,t].map(encodeURIComponent).join("=")).join("&")}function G(){const h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",e=h.length;let t="";for(let r=0;r<20;r++)t+=h[Math.floor(Math.random()*e)];return t}function O(h){return parseFloat((h/1e3).toFixed(2))}class le{constructor(){U(this,"locked",!1);U(this,"waitings",[]);this.unlock=this.unlock.bind(this)}lock(){return j(this,null,function*(){return this.locked?(yield new Promise(e=>{this.waitings.push(e)}),this.unlock):(this.locked=!0,this.unlock)})}unlock(){if(this.waitings.length===0){this.locked=!1;return}this.waitings.shift()()}runExclusive(e){return j(this,null,function*(){const t=yield this.lock();try{return yield e()}catch(r){throw r}finally{t()}})}}var N=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function W(h){var e=h.default;if(typeof e=="function"){var t=function(){return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(h).forEach(function(r){var f=Object.getOwnPropertyDescriptor(h,r);Object.defineProperty(t,r,f.get?f:{enumerable:!0,get:function(){return h[r]}})}),t}var V={exports:{}};(function(h,e){(function(t,r){var f="1.0.2",l="",p="?",L="function",y="undefined",_="object",m="string",x="major",i="model",o="name",a="type",s="vendor",u="version",T="architecture",n="console",c="mobile",d="tablet",w="smarttv",B="wearable",R="embedded",H=255,M="Amazon",q="Apple",Y="ASUS",F="BlackBerry",$="Browser",te="Chrome",rt="Edge",ie="Firefox",ae="Google",Pe="Huawei",pe="LG",me="Microsoft",Ce="Motorola",re="Opera",we="Samsung",be="Sony",Re="Xiaomi",ge="Zebra",Oe="Facebook",ot=function(b,k){var g={};for(var A in b)k[A]&&k[A].length%2===0?g[A]=k[A].concat(b[A]):g[A]=b[A];return g},oe=function(b){for(var k={},g=0;g<b.length;g++)k[b[g].toUpperCase()]=b[g];return k},Me=function(b,k){return typeof b===m?X(k).indexOf(X(b))!==-1:!1},X=function(b){return b.toLowerCase()},nt=function(b){return typeof b===m?b.replace(/[^\d\.]/g,l).split(".")[0]:r},ve=function(b,k){if(typeof b===m)return b=b.replace(/^\s\s*/,l).replace(/\s\s*$/,l),typeof k===y?b:b.substring(0,H)},Z=function(b,k){for(var g=0,A,v,se,S,Q,I;g<k.length&&!Q;){var De=k[g],Ie=k[g+1];for(A=v=0;A<De.length&&!Q;)if(Q=De[A++].exec(b),Q)for(se=0;se<Ie.length;se++)I=Q[++v],S=Ie[se],typeof S===_&&S.length>0?S.length===2?typeof S[1]==L?this[S[0]]=S[1].call(this,I):this[S[0]]=S[1]:S.length===3?typeof S[1]===L&&!(S[1].exec&&S[1].test)?this[S[0]]=I?S[1].call(this,I,S[2]):r:this[S[0]]=I?I.replace(S[1],S[2]):r:S.length===4&&(this[S[0]]=I?S[3].call(this,I.replace(S[1],S[2])):r):this[S]=I||r;g+=2}},ye=function(b,k){for(var g in k)if(typeof k[g]===_&&k[g].length>0){for(var A=0;A<k[g].length;A++)if(Me(k[g][A],b))return g===p?r:g}else if(Me(k[g],b))return g===p?r:g;return b},st={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Ne={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ze={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[u,[o,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[u,[o,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[o,u],[/opios[\/ ]+([\w\.]+)/i],[u,[o,re+" Mini"]],[/\bopr\/([\w\.]+)/i],[u,[o,re]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[o,u],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[u,[o,"UC"+$]],[/\bqbcore\/([\w\.]+)/i],[u,[o,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[u,[o,"WeChat"]],[/konqueror\/([\w\.]+)/i],[u,[o,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[u,[o,"IE"]],[/yabrowser\/([\w\.]+)/i],[u,[o,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[o,/(.+)/,"$1 Secure "+$],u],[/\bfocus\/([\w\.]+)/i],[u,[o,ie+" Focus"]],[/\bopt\/([\w\.]+)/i],[u,[o,re+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[u,[o,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[u,[o,"Dolphin"]],[/coast\/([\w\.]+)/i],[u,[o,re+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[u,[o,"MIUI "+$]],[/fxios\/([-\w\.]+)/i],[u,[o,ie]],[/\bqihu|(qi?ho?o?|360)browser/i],[[o,"360 "+$]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[o,/(.+)/,"$1 "+$],u],[/(comodo_dragon)\/([\w\.]+)/i],[[o,/_/g," "],u],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[o,u],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[o],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[o,Oe],u],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[o,u],[/\bgsa\/([\w\.]+) .*safari\//i],[u,[o,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[u,[o,te+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[o,te+" WebView"],u],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[u,[o,"Android "+$]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[o,u],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[u,[o,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[u,o],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[o,[u,ye,st]],[/(webkit|khtml)\/([\w\.]+)/i],[o,u],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[o,"Netscape"],u],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[u,[o,ie+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[o,u]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[T,"amd64"]],[/(ia32(?=;))/i],[[T,X]],[/((?:i[346]|x)86)[;\)]/i],[[T,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[T,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[T,"armhf"]],[/windows (ce|mobile); ppc;/i],[[T,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[T,/ower/,l,X]],[/(sun4\w)[;\)]/i],[[T,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[T,X]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[i,[s,we],[a,d]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[i,[s,we],[a,c]],[/\((ip(?:hone|od)[\w ]*);/i],[i,[s,q],[a,c]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[i,[s,q],[a,d]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[i,[s,Pe],[a,d]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[i,[s,Pe],[a,c]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[i,/_/g," "],[s,Re],[a,c]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[i,/_/g," "],[s,Re],[a,d]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[i,[s,"OPPO"],[a,c]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[i,[s,"Vivo"],[a,c]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[i,[s,"Realme"],[a,c]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[i,[s,Ce],[a,c]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[i,[s,Ce],[a,d]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[i,[s,pe],[a,d]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[i,[s,pe],[a,c]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[i,[s,"Lenovo"],[a,d]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[i,/_/g," "],[s,"Nokia"],[a,c]],[/(pixel c)\b/i],[i,[s,ae],[a,d]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[i,[s,ae],[a,c]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[i,[s,be],[a,c]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[i,"Xperia Tablet"],[s,be],[a,d]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[i,[s,"OnePlus"],[a,c]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[i,[s,M],[a,d]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[i,/(.+)/g,"Fire Phone $1"],[s,M],[a,c]],[/(playbook);[-\w\),; ]+(rim)/i],[i,s,[a,d]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[i,[s,F],[a,c]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[i,[s,Y],[a,d]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[i,[s,Y],[a,c]],[/(nexus 9)/i],[i,[s,"HTC"],[a,d]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[s,[i,/_/g," "],[a,c]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[i,[s,"Acer"],[a,d]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[i,[s,"Meizu"],[a,c]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[i,[s,"Sharp"],[a,c]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[s,i,[a,c]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[s,i,[a,d]],[/(surface duo)/i],[i,[s,me],[a,d]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[i,[s,"Fairphone"],[a,c]],[/(u304aa)/i],[i,[s,"AT&T"],[a,c]],[/\bsie-(\w*)/i],[i,[s,"Siemens"],[a,c]],[/\b(rct\w+) b/i],[i,[s,"RCA"],[a,d]],[/\b(venue[\d ]{2,7}) b/i],[i,[s,"Dell"],[a,d]],[/\b(q(?:mv|ta)\w+) b/i],[i,[s,"Verizon"],[a,d]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[i,[s,"Barnes & Noble"],[a,d]],[/\b(tm\d{3}\w+) b/i],[i,[s,"NuVision"],[a,d]],[/\b(k88) b/i],[i,[s,"ZTE"],[a,d]],[/\b(nx\d{3}j) b/i],[i,[s,"ZTE"],[a,c]],[/\b(gen\d{3}) b.+49h/i],[i,[s,"Swiss"],[a,c]],[/\b(zur\d{3}) b/i],[i,[s,"Swiss"],[a,d]],[/\b((zeki)?tb.*\b) b/i],[i,[s,"Zeki"],[a,d]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[s,"Dragon Touch"],i,[a,d]],[/\b(ns-?\w{0,9}) b/i],[i,[s,"Insignia"],[a,d]],[/\b((nxa|next)-?\w{0,9}) b/i],[i,[s,"NextBook"],[a,d]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[s,"Voice"],i,[a,c]],[/\b(lvtel\-)?(v1[12]) b/i],[[s,"LvTel"],i,[a,c]],[/\b(ph-1) /i],[i,[s,"Essential"],[a,c]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[i,[s,"Envizen"],[a,d]],[/\b(trio[-\w\. ]+) b/i],[i,[s,"MachSpeed"],[a,d]],[/\btu_(1491) b/i],[i,[s,"Rotor"],[a,d]],[/(shield[\w ]+) b/i],[i,[s,"Nvidia"],[a,d]],[/(sprint) (\w+)/i],[s,i,[a,c]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[s,me],[a,c]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[i,[s,ge],[a,d]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[i,[s,ge],[a,c]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[s,i,[a,n]],[/droid.+; (shield) bui/i],[i,[s,"Nvidia"],[a,n]],[/(playstation [345portablevi]+)/i],[i,[s,be],[a,n]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[i,[s,me],[a,n]],[/smart-tv.+(samsung)/i],[s,[a,w]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[s,we],[a,w]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[s,pe],[a,w]],[/(apple) ?tv/i],[s,[i,q+" TV"],[a,w]],[/crkey/i],[[i,te+"cast"],[s,ae],[a,w]],[/droid.+aft(\w)( bui|\))/i],[i,[s,M],[a,w]],[/\(dtv[\);].+(aquos)/i],[i,[s,"Sharp"],[a,w]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[s,ve],[i,ve],[a,w]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[a,w]],[/((pebble))app/i],[s,i,[a,B]],[/droid.+; (glass) \d/i],[i,[s,ae],[a,B]],[/droid.+; (wt63?0{2,3})\)/i],[i,[s,ge],[a,B]],[/(quest( 2)?)/i],[i,[s,Oe],[a,B]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[s,[a,R]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[i,[a,c]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[i,[a,d]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[a,d]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[a,c]],[/(android[-\w\. ]{0,9});.+buil/i],[i,[s,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[u,[o,rt+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[u,[o,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[o,u],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[u,o]],os:[[/microsoft (windows) (vista|xp)/i],[o,u],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[o,[u,ye,Ne]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[o,"Windows"],[u,ye,Ne]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[u,/_/g,"."],[o,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[o,"Mac OS"],[u,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[u,o],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[o,u],[/\(bb(10);/i],[u,[o,F]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[u,[o,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[u,[o,ie+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[u,[o,"webOS"]],[/crkey\/([\d\.]+)/i],[u,[o,te+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[o,"Chromium OS"],u],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[o,u],[/(sunos) ?([\w\.\d]*)/i],[[o,"Solaris"],u],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[o,u]]},D=function(b,k){if(typeof b===_&&(k=b,b=r),!(this instanceof D))return new D(b,k).getResult();var g=b||(typeof t!==y&&t.navigator&&t.navigator.userAgent?t.navigator.userAgent:l),A=k?ot(ze,k):ze;return this.getBrowser=function(){var v={};return v[o]=r,v[u]=r,Z.call(v,g,A.browser),v.major=nt(v.version),v},this.getCPU=function(){var v={};return v[T]=r,Z.call(v,g,A.cpu),v},this.getDevice=function(){var v={};return v[s]=r,v[i]=r,v[a]=r,Z.call(v,g,A.device),v},this.getEngine=function(){var v={};return v[o]=r,v[u]=r,Z.call(v,g,A.engine),v},this.getOS=function(){var v={};return v[o]=r,v[u]=r,Z.call(v,g,A.os),v},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return g},this.setUA=function(v){return g=typeof v===m&&v.length>H?ve(v,H):v,this},this.setUA(g),this};D.VERSION=f,D.BROWSER=oe([o,u,x]),D.CPU=oe([T]),D.DEVICE=oe([i,s,a,n,c,w,d,B,R]),D.ENGINE=D.OS=oe([o,u]),h.exports&&(e=h.exports=D),e.UAParser=D;var K=typeof t!==y&&(t.jQuery||t.Zepto);if(K&&!K.ua){var ne=new D;K.ua=ne.getResult(),K.ua.get=function(){return ne.getUA()},K.ua.set=function(b){ne.setUA(b);var k=ne.getResult();for(var g in k)K.ua[g]=k[g]}}})(typeof window=="object"?window:N)})(V,V.exports);const ke=V.exports,qe="1.1.1";function Ve(){var f,l;const{os:h,device:e,browser:t}=ke(navigator.userAgent);let r;return typeof window!="undefined"?r=window.location:typeof self!==void 0&&(r=self.location),{os:`${h.name}_${h.version}`,browser:`${t.name}_${t.version}`,app:(f=r==null?void 0:r.host)!=null?f:"",sdk:`Web SDK v${qe}`,dev_model:(l=e.model)!=null?l:"",dev_id:""}}var Le={exports:{}};function He(h){throw new Error('Could not dynamically require "'+h+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ue={exports:{}};const je=W(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var Se;function J(){return Se||(Se=1,function(h,e){(function(t,r){h.exports=r()})(N,function(){var t=t||function(r,f){var l;if(typeof window!="undefined"&&window.crypto&&(l=window.crypto),typeof self!="undefined"&&self.crypto&&(l=self.crypto),typeof globalThis!="undefined"&&globalThis.crypto&&(l=globalThis.crypto),!l&&typeof window!="undefined"&&window.msCrypto&&(l=window.msCrypto),!l&&typeof N!="undefined"&&N.crypto&&(l=N.crypto),!l&&typeof He=="function")try{l=je}catch(n){}var p=function(){if(l){if(typeof l.getRandomValues=="function")try{return l.getRandomValues(new Uint32Array(1))[0]}catch(n){}if(typeof l.randomBytes=="function")try{return l.randomBytes(4).readInt32LE()}catch(n){}}throw new Error("Native crypto module could not be used to get secure random number.")},L=Object.create||function(){function n(){}return function(c){var d;return n.prototype=c,d=new n,n.prototype=null,d}}(),y={},_=y.lib={},m=_.Base=function(){return{extend:function(n){var c=L(this);return n&&c.mixIn(n),(!c.hasOwnProperty("init")||this.init===c.init)&&(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var c in n)n.hasOwnProperty(c)&&(this[c]=n[c]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),x=_.WordArray=m.extend({init:function(n,c){n=this.words=n||[],c!=f?this.sigBytes=c:this.sigBytes=n.length*4},toString:function(n){return(n||o).stringify(this)},concat:function(n){var c=this.words,d=n.words,w=this.sigBytes,B=n.sigBytes;if(this.clamp(),w%4)for(var R=0;R<B;R++){var H=d[R>>>2]>>>24-R%4*8&255;c[w+R>>>2]|=H<<24-(w+R)%4*8}else for(var M=0;M<B;M+=4)c[w+M>>>2]=d[M>>>2];return this.sigBytes+=B,this},clamp:function(){var n=this.words,c=this.sigBytes;n[c>>>2]&=4294967295<<32-c%4*8,n.length=r.ceil(c/4)},clone:function(){var n=m.clone.call(this);return n.words=this.words.slice(0),n},random:function(n){for(var c=[],d=0;d<n;d+=4)c.push(p());return new x.init(c,n)}}),i=y.enc={},o=i.Hex={stringify:function(n){for(var c=n.words,d=n.sigBytes,w=[],B=0;B<d;B++){var R=c[B>>>2]>>>24-B%4*8&255;w.push((R>>>4).toString(16)),w.push((R&15).toString(16))}return w.join("")},parse:function(n){for(var c=n.length,d=[],w=0;w<c;w+=2)d[w>>>3]|=parseInt(n.substr(w,2),16)<<24-w%8*4;return new x.init(d,c/2)}},a=i.Latin1={stringify:function(n){for(var c=n.words,d=n.sigBytes,w=[],B=0;B<d;B++){var R=c[B>>>2]>>>24-B%4*8&255;w.push(String.fromCharCode(R))}return w.join("")},parse:function(n){for(var c=n.length,d=[],w=0;w<c;w++)d[w>>>2]|=(n.charCodeAt(w)&255)<<24-w%4*8;return new x.init(d,c)}},s=i.Utf8={stringify:function(n){try{return decodeURIComponent(escape(a.stringify(n)))}catch(c){throw new Error("Malformed UTF-8 data")}},parse:function(n){return a.parse(unescape(encodeURIComponent(n)))}},u=_.BufferedBlockAlgorithm=m.extend({reset:function(){this._data=new x.init,this._nDataBytes=0},_append:function(n){typeof n=="string"&&(n=s.parse(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes},_process:function(n){var c,d=this._data,w=d.words,B=d.sigBytes,R=this.blockSize,H=R*4,M=B/H;n?M=r.ceil(M):M=r.max((M|0)-this._minBufferSize,0);var q=M*R,Y=r.min(q*4,B);if(q){for(var F=0;F<q;F+=R)this._doProcessBlock(w,F);c=w.splice(0,q),d.sigBytes-=Y}return new x.init(c,Y)},clone:function(){var n=m.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0});_.Hasher=u.extend({cfg:m.extend(),init:function(n){this.cfg=this.cfg.extend(n),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){n&&this._append(n);var c=this._doFinalize();return c},blockSize:16,_createHelper:function(n){return function(c,d){return new n.init(d).finalize(c)}},_createHmacHelper:function(n){return function(c,d){return new T.HMAC.init(n,d).finalize(c)}}});var T=y.algo={};return y}(Math);return t})}(ue)),ue.exports}var de={exports:{}},Te;function Fe(){return Te||(Te=1,function(h,e){(function(t,r){h.exports=r(J())})(N,function(t){return function(){var r=t,f=r.lib,l=f.WordArray,p=f.Hasher,L=r.algo,y=[],_=L.SHA1=p.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,x){for(var i=this._hash.words,o=i[0],a=i[1],s=i[2],u=i[3],T=i[4],n=0;n<80;n++){if(n<16)y[n]=m[x+n]|0;else{var c=y[n-3]^y[n-8]^y[n-14]^y[n-16];y[n]=c<<1|c>>>31}var d=(o<<5|o>>>27)+T+y[n];n<20?d+=(a&s|~a&u)+1518500249:n<40?d+=(a^s^u)+1859775393:n<60?d+=(a&s|a&u|s&u)-1894007588:d+=(a^s^u)-899497514,T=u,u=s,s=a<<30|a>>>2,a=o,o=d}i[0]=i[0]+o|0,i[1]=i[1]+a|0,i[2]=i[2]+s|0,i[3]=i[3]+u|0,i[4]=i[4]+T|0},_doFinalize:function(){var m=this._data,x=m.words,i=this._nDataBytes*8,o=m.sigBytes*8;return x[o>>>5]|=128<<24-o%32,x[(o+64>>>9<<4)+14]=Math.floor(i/4294967296),x[(o+64>>>9<<4)+15]=i,m.sigBytes=x.length*4,this._process(),this._hash},clone:function(){var m=p.clone.call(this);return m._hash=this._hash.clone(),m}});r.SHA1=p._createHelper(_),r.HmacSHA1=p._createHmacHelper(_)}(),t.SHA1})}(de)),de.exports}var fe={exports:{}},Ee;function $e(){return Ee||(Ee=1,function(h,e){(function(t,r){h.exports=r(J())})(N,function(t){(function(){var r=t,f=r.lib,l=f.Base,p=r.enc,L=p.Utf8,y=r.algo;y.HMAC=l.extend({init:function(_,m){_=this._hasher=new _.init,typeof m=="string"&&(m=L.parse(m));var x=_.blockSize,i=x*4;m.sigBytes>i&&(m=_.finalize(m)),m.clamp();for(var o=this._oKey=m.clone(),a=this._iKey=m.clone(),s=o.words,u=a.words,T=0;T<x;T++)s[T]^=1549556828,u[T]^=909522486;o.sigBytes=a.sigBytes=i,this.reset()},reset:function(){var _=this._hasher;_.reset(),_.update(this._iKey)},update:function(_){return this._hasher.update(_),this},finalize:function(_){var m=this._hasher,x=m.finalize(_);m.reset();var i=m.finalize(this._oKey.clone().concat(x));return i}})})()})}(fe)),fe.exports}(function(h,e){(function(t,r,f){h.exports=r(J(),Fe(),$e())})(N,function(t){return t.HmacSHA1})})(Le);const Ke=Le.exports;var Be={exports:{}};(function(h,e){(function(t,r){h.exports=r(J())})(N,function(t){return function(){var r=t,f=r.lib,l=f.WordArray,p=r.enc;p.Base64={stringify:function(y){var _=y.words,m=y.sigBytes,x=this._map;y.clamp();for(var i=[],o=0;o<m;o+=3)for(var a=_[o>>>2]>>>24-o%4*8&255,s=_[o+1>>>2]>>>24-(o+1)%4*8&255,u=_[o+2>>>2]>>>24-(o+2)%4*8&255,T=a<<16|s<<8|u,n=0;n<4&&o+n*.75<m;n++)i.push(x.charAt(T>>>6*(3-n)&63));var c=x.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(y){var _=y.length,m=this._map,x=this._reverseMap;if(!x){x=this._reverseMap=[];for(var i=0;i<m.length;i++)x[m.charCodeAt(i)]=i}var o=m.charAt(64);if(o){var a=y.indexOf(o);a!==-1&&(_=a)}return L(y,_,x)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function L(y,_,m){for(var x=[],i=0,o=0;o<_;o++)if(o%4){var a=m[y.charCodeAt(o-1)]<<o%4*2,s=m[y.charCodeAt(o)]>>>6-o%4*2,u=a|s;x[i>>>2]|=u<<24-i%4*8,i++}return l.create(x,i)}}(),t.enc.Base64})})(Be);const Ge=Be.exports;function Ye(h){let e=h.query?`${h.path}?${h.query}
`:`${h.path}
`;return h.body&&(e+=h.body),e}function Xe(h){let e;try{e=new URL(h.path).pathname}catch(L){e=h.path}let t=Ye(We(xe({},h),{path:e}));const l=Ke(t,h.appSalt).toString(Ge).replace(/\+/g,"-").replace(/\//g,"_");let p=`QApp ${h.appID}:${l}`;return p=p.replace(/\//g,"_"),p=p.replace(/\+/g,"-"),p}const he=200,Ze=P("log");class Qe{constructor(e,t=self.fetch,r=100,f=3){U(this,"env",ce(Ve()));U(this,"flushMutex",new le);U(this,"buffer",[]);this.appInfo=e,this.fetch=t,this.flushNum=r,this.flushWait=f}callApiLog(e){return j(this,null,function*(){const t=this.fetch;try{const r=Je(e),f=r.map(L=>L.schema).join(","),l=Xe({appID:this.appInfo.appID,appSalt:this.appInfo.appSalt,path:`${E}/v1/log/${f}`}),p=yield t(new Request(`${E}/v1/log/${f}`,{method:"POST",headers:{Authorization:l,"Content-Type":"text/csv","X-Env":this.env},body:et(r)}));if(!p.ok)throw new Error(`Unexpected response status: ${p.status} ${p.statusText}`)}catch(r){Ze("Call log API failed:",r)}})}flush(){return this.flushMutex.runExclusive(()=>{const e=this.buffer.splice(0);if(e.length===0)return;const t=Math.ceil(e.length/he);return Promise.all(Array.from({length:t}).map((r,f)=>this.callApiLog(e.slice(f*he,(f+1)*he))))})}tryFlush(){return j(this,null,function*(){const e=yield this.flushMutex.runExclusive(()=>{const t=this.buffer;if(t.length===0)return!1;if(t.length>=this.flushNum)return!0;const r=Date.now()-t[0].log.ts;return r>=this.flushWait*1e3?!0:this.flushWait*1e3-r});if(e===!0)return this.flush();typeof e=="number"&&setTimeout(()=>this.tryFlush(),e)})}log(e,t){this.buffer.push({schema:e,log:xe({ts:Date.now()},t)}),this.tryFlush()}}function Je(h){const e=[];return h.forEach(({schema:t,log:r})=>{let f=e.find(l=>l.schema===t);f==null&&(f={schema:t,logs:[]},e.push(f)),f.logs.push(r)}),e}function et(h){return h.map(e=>e.logs).map(tt).join(`

`)}function tt(h){const e=Object.keys(h[0]),t=["ts",...e.filter(l=>l!=="ts")],r=t.map(Ae).join(","),f=h.map(l=>t.map(p=>l[p]).map(p=>p!=null?p+"":"").map(Ae).join(","));return[r,...f].join(`
`)}function Ae(h){let e=h.replace(/"/g,'""');return/("|,|\n)/.test(e)&&(e='"'+e+'"'),e}ke(navigator.userAgent);const it="miku-delivery/dc/v1",ee=class{constructor(e,t,r){U(this,"pageLogData",{r_id:G(),ts:0,url:"",tag:"nocache",tag_reason:"",t_page_load:0,t_full_load:0,t_window_load:0});U(this,"logger");U(this,"lastLiveUrl","");this.tag=e,this.tagReason=t,this.app=r,this.logger=new Qe(r,void 0,void 0,3)}static initInstance(e,t,r){var p;const f=new ee(e,t,r);f.pageLoadPerformance(),f.resourceLoadPerformance(),f.videoLoadPerformance(),ee.mikuPerformanceInstance=f;const l={mikuDeliveryProxy:!0,type:"get-perf-rid",rid:f.pageLogData.r_id};return(p=navigator.serviceWorker.controller)==null||p.postMessage(l),f}pageLoadPerformance(){let e=new PerformanceObserver(t=>{t.getEntries().forEach(r=>{r.entryType==="navigation"&&r.initiatorType==="navigation"&&(this.pageLogData.ts=Date.now(),this.pageLogData.url=window.location.href,this.pageLogData.tag=this.tag,this.pageLogData.t_window_load=O(r.loadEventEnd-r.fetchStart),performance.getEntriesByType("paint").forEach(l=>{l.name==="first-contentful-paint"?this.pageLogData.t_full_load=O(l.startTime):l.name==="first-paint"&&(this.pageLogData.t_page_load=O(l.startTime))}),Promise.resolve(this.tagReason).then(l=>{this.pageLogData.tag_reason=l,this.submitPageLoadLog()}),e.disconnect())})});e.observe({entryTypes:["navigation"]})}resourceLoadPerformance(){new PerformanceObserver(t=>{t.getEntries().forEach(r=>{const f=new URL(r.name),l=f.pathname,p=f.hostname;r.entryType==="resource"&&p!==new URL(E).hostname&&(/\.(flv|m3u8)$/.test(l)?this.lastLiveUrl=r.name:/\.(3gp|aac|flac|mpe?g|mp3|mp4|m4a|m4v|m4p|oga|ogg|ogv|wav|webm|mov)$/.test(l)&&(this.lastLiveUrl=""),this.submitResourceLoadLog({r_id:this.pageLogData.r_id,ts:Date.now(),url:r.name,t_page_perf:O(r.duration)}))})}).observe({entryTypes:["resource"]})}videoLoadPerformance(){const e=[];new MutationObserver(()=>{const r=document.getElementsByTagName("video");for(const f of Array.from(r)){const l=f;e.includes(l)||(e.push(l),this.addVideoEventListener(l))}}).observe(document.body,{subtree:!0,childList:!0})}addVideoEventListener(e){let t=this.resetVideoLogData(),r="";e.addEventListener("loadstart",l=>{r=this.checknrestartVideoLog(t,e,l,r)}),e.addEventListener("loadedmetadata",l=>{r=this.checknrestartVideoLog(t,e,l,r),t.t_loaded_metadata=O(l.timeStamp-t.start)}),e.addEventListener("loadeddata",l=>{r=this.checknrestartVideoLog(t,e,l,r),t.t_loaded_data=O(l.timeStamp-t.start),t.t_duration=e.duration===1/0||Number.isNaN(e.duration)?-1:Number(e.duration.toFixed(2)),t.playback_rate=e.playbackRate,this.submitVideoLoadLog(t),t.lastSubmitLogTime=performance.now()}),e.addEventListener("seeking",()=>{t.isSeeking=!0,t.lastSeekingTime=performance.now()}),e.addEventListener("playing",l=>{r=this.checknrestartVideoLog(t,e,l,r);const p=performance.now();if(t.lastPlayingTime=p,t.lastWaitingTime){const L=p-t.lastWaitingTime;t.t_jank_total+=L,t.t_play_total+=L,t.lastWaitingTime=0}if(t.lastSeekingTime){const L=p-t.lastSeekingTime;t.t_seek_total+=L,t.t_play_total+=L,t.lastSeekingTime=0}}),e.addEventListener("timeupdate",()=>{performance.now()-t.lastSubmitLogTime>1e4&&(this.submitVideoLoadLog(t),t.lastSubmitLogTime=performance.now())});const f=()=>{const l=performance.now();if(t.lastPlayingTime){const p=l-t.lastPlayingTime;t.t_play_total+=p,t.lastPlayingTime=0}if(t.lastWaitingTime){const p=l-t.lastWaitingTime;t.t_jank_total+=p,t.t_play_total+=p,t.lastWaitingTime=0}if(t.lastSeekingTime){const p=l-t.lastSeekingTime;t.t_seek_total+=p,t.t_play_total+=p,t.lastSeekingTime=0}this.submitVideoLoadLog(t),t.lastSubmitLogTime=performance.now()};e.addEventListener("pause",f),e.addEventListener("stop",f),e.addEventListener("waiting",()=>{const l=performance.now();if(t.lastPlayingTime){const p=l-t.lastPlayingTime;t.t_play_total+=p,t.lastPlayingTime=0}t.isSeeking?t.isSeeking=!1:t.lastWaitingTime=l})}submitResourceLoadLog(e){this.logger.log("PageResourceLoadLog",e)}submitPageLoadLog(){this.logger.log("PageLoadLog",this.pageLogData)}submitVideoLoadLog(e){const t=performance.now(),r=e.lastPlayingTime?O(e.t_play_total+t-e.lastPlayingTime):O(e.t_play_total),f=e.lastWaitingTime?O(e.t_jank_total+t-e.lastWaitingTime):O(e.t_jank_total),l=e.lastSeekingTime?O(e.t_seek_total+t-e.lastSeekingTime):O(e.t_seek_total),p={r_id:e.r_id,s_id:e.s_id,ts:Date.now(),protocol:e.protocol,domain:e.domain,path:e.path,ts_play:e.ts_play,t_loaded_metadata:e.t_loaded_metadata,t_loaded_data:e.t_loaded_data,playback_rate:e.playback_rate,t_duration:e.type===0?e.t_duration:0,type:e.type,t_play_total:r,t_jank_total:e.type===0?f:l+f,t_seek_total:e.type===0?l:0};this.logger.log("PageVideoLoadLog",p)}checknrestartVideoLog(e,t,r,f){return this.isChangeVideoSource(f,t.src)&&(f=t.src,this.submitVideoLoadLog(e),e=this.resetVideoLogData()),this.getVideoBasicMessage(e,t,r),f}isChangeVideoSource(e,t){return e!==""&&e!==t}getVideoBasicMessage(e,t,r){if(e.path)return!1;let f="";this.lastLiveUrl?(f=this.lastLiveUrl,e.type=2):f=t.src,e.path=f;try{const l=new URL(f);e.protocol=l.protocol.slice(0,-1),e.domain=l.host}catch(l){const p=new URL(f.replace("blob:",""));e.protocol=p.protocol.slice(0,-1),e.domain=p.host}e.ts_play=Date.now(),e.start=r.timeStamp}resetVideoLogData(){return{ts:0,r_id:this.pageLogData.r_id,s_id:G(),protocol:"",domain:"",path:"",ts_play:0,t_play_total:0,t_loaded_metadata:0,t_loaded_data:0,t_jank_total:0,t_seek_total:0,playback_rate:0,type:1,t_duration:0,start:0,isSeeking:!1,lastPlayingTime:0,lastWaitingTime:0,lastSeekingTime:0,lastSubmitLogTime:0}}};let z=ee;U(z,"mikuPerformanceInstance");const at=(h,e=!0,t)=>j(this,null,function*(){const f=yield(yield caches.open(it)).keys();return new Promise((l,p)=>{if(z.mikuPerformanceInstance===void 0){if(t){l(z.initInstance(t,"",h));return}"serviceWorker"in navigator?navigator.serviceWorker.getRegistrations().then(function(L){return j(this,null,function*(){if(L.length===0)l(z.initInstance("direct",Promise.resolve(e).then(y=>y?"sw_not_registered":"no_miku"),h));else try{f.length?l(z.initInstance("cache","",h)):l(z.initInstance("nocache","",h))}catch(y){p(y)}})}).catch(L=>{p(L)}):l(z.initInstance("direct",Promise.resolve(e).then(L=>L?"sw_not_supported":"no_miku"),h))}else l(z.mikuPerformanceInstance)})});return C.MikuDeliveryPerformance=z,C.init=at,Object.defineProperties(C,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),C}({});
